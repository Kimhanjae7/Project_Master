<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>내 정보</title>
    <link rel="stylesheet" type="text/css" href="/css/myProfile.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Bagel+Fat+One&family=Jua&family=Nanum+Pen+Script&family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <!--차트 출력-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="/myProfile_.js"></script>
    <script>
        function editProfile() {
            document.querySelectorAll('.profile-input').forEach(input => {
                input.removeAttribute('disabled');
            });
            document.getElementById('editButton').style.display = 'none';
            document.getElementById('saveButton').style.display = 'inline';
            document.getElementById('cancelButton').style.display = 'inline';
        }

        function cancelEdit() {
            document.querySelectorAll('.profile-input').forEach(input => {
                input.setAttribute('disabled', true);
                input.value = input.dataset.originalValue;
            });
            document.getElementById('editButton').style.display = 'inline';
            document.getElementById('saveButton').style.display = 'none';
            document.getElementById('cancelButton').style.display = 'none';
        }
    </script>
</head>
<body>
    <div class="wrap">
        <div class="profile_top">
            <div class="profile_logo">
                <a href="/"><img src="/images/PM_logo_fin.png"></a><br>
                <span>Project Master</span><br><br>
            </div>
            <div class="menubar">
                <ul class="nav">
                    <li><a href="/">HOME</a></li>
                    <li><a href="/alarms">알림</a></li>
                    <li><a href="/join">회원가입</a></li>
                    <li><a href="/login">로그인</a></li>
                </ul>
            </div>
        </div>
        <div class="bottom_wrap">
            <div class="bottom_bg">
                <div class="bottom">
                    <div class="section">
                        <div class="profile_body">
                          <div class="profile_body_top">
                            <button type="button" class="edit-button" id="editButton" onclick="editProfile()">정보수정</button>
                            <button type="button" class="edit-button" id="cancelButton" style="display:none;" onclick="cancelEdit()">취소</button>
                          </div>
                          <form action="/mypageProc" method="post">
                            <div class="profile_body_bottom">
                              <div class="profile_body_bottom_div left-align">
                                <label class="myinfo_style"><span style = "font-size : 12pt; font-weight : bold">닉네임 : </span> <span id="nickname"></span>
                                  <input type="text" id="nickname" name="nickname" class="profile-input" value="<%= member.nickname %>" data-original-value="<%= member.nickname %>" disabled>
                                </label>
                    
                                <label class="myinfo_style"><span style = "font-size : 12pt; font-weight : bold">링크 : </span> <span id="link"></span>
                                    <input type="text" id="link" name="link" class="profile-input" value="<%= member.link %>" data-original-value="<%= member.link %>" disabled>
                                </label>
                    
                                <label class="myinfo_style"><span style = "font-size : 12pt; font-weight : bold">소속 : </span> <span id="affiliation"></span>
                                    <input type="text" id="affiliation" name="affiliation" class="profile-input" value="<%= member.affiliation %>" data-original-value="<%= member.affiliation %>" disabled>
                                </label>
                    
                                <label class="myinfo_style"><span style = "font-size : 12pt; font-weight : bold">직무 : </span> <span id="job"></span>
                                  <select name="job" id="job" style="display:none;" class="select_style" value="<%= member.job %>" data-original-value="<%= member.job %>" disabled>
                                    <option selected disabled hidden>직무를 변경하세요</option>
                                    <option value="frontend">프론트엔드</option>
                                    <option value="backend">백엔드</option>
                                    <option value="designer">디자이너</option>
                                    <option value="ios">IOS</option>
                                    <option value="android">안드로이드</option>
                                    <option value="devops">데브옵스</option>
                                    <option value="planner">기획자</option>
                                    <option value="pm">PM</option>
                                    <option value="marketer">마케터</option>
                                  </select>
                                </label>
                    
                                <label class="myinfo_style">경력 : <span id="experience"></span>
                                  <select name="career" id="experienceInput" style="display:none;" class="select_style">
                                    <option selected disabled hidden>경력을 변경하세요</option>
                                    <option value="0">1년 미만</option>
                                    <option value="1">1년</option>
                                    <option value="2">2년</option>
                                    <option value="3">3년</option>
                                    <option value="4">4년</option>
                                    <option value="5">5년 이상</option>
                                  </select>
                                </label>
                    
                                <label class="myinfo_style size_up">관심스택 :
                                  <select name="interest_stack" id="stackInput" style="display:none;" class="select_stack_style">
                                    <optgroup label="프론트엔드">
                                      <option selected disabled hidden>기술스택</option>
                                      <option value="JavaScript">JavaScript</option>
                                      <option value="TypeScript">TypeScript</option>
                                      <option value="React">React</option>
                                      <option value="Vue">Vue</option>
                                      <option value="Svelte">Svelte</option>
                                      <option value="Nextjs">Nextjs</option>
                                    </optgroup>
                                    <optgroup label="백엔드">
                                      <option value="Nodejs">Nodejs</option>
                                      <option value="Java">Java</option>
                                      <option value="Spring">Spring</option>
                                      <option value="Go">Go</option>
                                      <option value="Nestjs">Nestjs</option>
                                      <option value="Kotlin">Kotlin</option>
                                      <option value="Express">Express</option>
                                      <option value="MySQL">MySQL</option>
                                      <option value="MonggoDB">MonggoDB</option>
                                      <option value="Python">Python</option>
                                      <option value="Django">Django</option>
                                      <option value="php">php</option>
                                      <option value="GraphQL">GraphQL</option>
                                      <option value="Firebase">Firebase</option>
                                    </optgroup>
                                    <optgroup label="모바일">
                                      <option value="Flutter">Flutter</option>
                                      <option value="Swift">Swift</option>
                                      <option value="ReactNative">ReactNative</option>
                                      <option value="Unity">Unity</option>
                                    </optgroup>
                                    <optgroup label="기타">
                                      <option value="AWS">AWS</option>
                                      <option value="Kubernetes">Kubernetes</option>
                                      <option value="Docker">Docker</option>
                                      <option value="Git">Git</option>
                                      <option value="Figma">Figma</option>
                                      <option value="Zeplin">Zeplin</option>
                                      <option value="Jest">Jest</option>
                                    </optgroup>
                                  </select>
                                </label>
                              </div>
                              <div class="profile_body_bottom_div_center">
                                <span class="font_style margin_bottom"><%= member.nickname %>님의 프로필</span>
                                <div class="profile_image" id="image_show">
                                  <img src="/images/코딩2.webp" id="profileImage">
                                </div>
                                <input type="file" accept="image/*" onchange="loadFile(this)" style="display:none;" class="file_input_style">
                              </div>
                              <div class="profile_body_bottom_div">
                                <div class="profile_myinfo_area">
                                  <div class="profile_myinfo">
                                    <div class="myinfo_text">
                                      <span class="font_style2">자기소개</span>
                                      <div id="selfIntroduction"></div>
                                      <textarea name="introduce" id="selfIntroductionInput" style="display:none;" class="textarea_style"></textarea>
                                    </div>
                                  </div>
                                </div>
                                <div class="contact_area">
                                  <div class="contact">
                                    <div class="contact_text">
                                      <span class="contact_span">연락방법 :</span>
                                      <span id="contact"></span>
                                      <input type="text" name="contact_way" id="contactInput" style="display:none;" class="input_style2">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div>
                              <button type="submit" class="edit-button" id="saveButton" style="display:none;">수정완료</button>
                            </div>
                        </div>
                      </div>
                    <div class="section">
                        <div class="half_section">
                            <div class="half_left">
                                <br><span class="font_style">나의 프로젝트 참여 현황</span><br>
                                <div class="half_left_div">
                                    <div class="chart_area">
                                        <div id="doughnutChart" class="chart"></div>
                                        <script src="/profile_jobcount_chart.js"></script>
                                    </div>
                                    <div class="job_area">
                                        <div class="myjob_count_area">
                                            <span class="font_style3"><span class="hyphen" style="color: #E0F2F7; background-color: #E0F2F7;">─</span> 프론트엔드 : <%= grade.Front_end_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #A9E2F3; background-color: #A9E2F3;">─</span> 백엔드 : <%= grade.Back_end_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #A9BCF5; background-color: #A9BCF5;">─</span> 디자이너 : <%= grade.Designer_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #D0A9F5; background-color: #D0A9F5;">─</span> IOS : <%= grade.IOS_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #0431B4; background-color: #0431B4;">─</span> 안드로이드 : <%= grade.Android_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #FFFFFF; background-color: #FFFFFF;">─</span> 데브옵스 : <%= grade.DevOps_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #CECEF6; background-color: #CECEF6;">─</span> PM : <%= grade.PM_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #00BFFF; background-color: #00BFFF;">─</span> 기획자 : <%= grade.Planner_count || 0 %>회</span><br>
                                            <span class="font_style3"><span class="hyphen" style="color: #8181F7; background-color: #8181F7;">─</span> 마케터 : <%= grade.Marketer_count || 0 %>회</span><br>
                                          </div>
                                    </div>                                    
                                </div>
                            </div>
                              <!-- Pass the data to JavaScript -->
                            <script>
                                const jobCounts = [
                                { title: "프론트엔드", value: <%= grade.Front_end_count || 0 %>, color: "#E0F2F7" },
                                { title: "백엔드", value: <%= grade.Back_end_count || 0 %>, color: "#A9E2F3" },
                                { title: "디자이너", value: <%= grade.Designer_count || 0 %>, color: "#A9BCF5" },
                                { title: "IOS", value: <%= grade.IOS_count || 0 %>, color: "#D0A9F5" },
                                { title: "안드로이드", value: <%= grade.Android_count || 0 %>, color: "#0431B4" },
                                { title: "데브옵스", value: <%= grade.DevOps_count || 0 %>, color: "#FFFFFF" },
                                { title: "PM", value: <%= grade.PM_count || 0 %>, color: "#CECEF6" },
                                { title: "기획자", value: <%= grade.Planner_count || 0 %>, color: "#00BFFF" },
                                { title: "마케터", value: <%= grade.Marketer_count || 0 %>, color: "#8181F7" }
                                ];
                            </script>
                            
                            <div class="half_right">
                                <br><span class="font_style">나의 프로젝트 평점</span><br>
                                <div id="container"></div><br>
                                <script src="/profile_score_chart.js"></script>
                            </div>

                            <script>
                                const averageRatings = [
                                  <%= grade.Front_end_average_rating || 0 %>,
                                  <%= grade.Back_end_average_rating || 0 %>,
                                  <%= grade.Designer_average_rating || 0 %>,
                                  <%= grade.IOS_average_rating || 0 %>,
                                  <%= grade.Android_average_rating || 0 %>,
                                  <%= grade.DevOps_average_rating || 0 %>,
                                  <%= grade.PM_average_rating || 0 %>,
                                  <%= grade.Planner_average_rating || 0 %>,
                                  <%= grade.Marketer_average_rating || 0 %>
                                ];
                            </script>

                                <script>
                                    $(function() {
                                    $('#container').highcharts({
                                        chart: {
                                        polar: true,
                                        type: 'line'
                                        },
                                        credits: {
                                        enabled: false
                                        },
                                        title: {
                                        text: ''
                                        },
                                        pane: {
                                        startAngle: 0,
                                        endAngle: 360
                                        },
                                        xAxis: {
                                        type: 'category',
                                        tickInterval: 1,
                                        categories: ['프론트엔드', '백엔드', '디자이너', 'IOS', '안드로이드', '데브옵스', 'PM', '기획자', '마케터'],
                                        min: 0,
                                        max: 9,
                                        tickmarkPlacement: 'on',
                                        lineWidth: 0,
                                        labels: {
                                            formatter: function () {
                                            return this.value
                                            }
                                        }
                                        },
                                        tooltip: {
                                        shared: true,
                                        useHTML: true,
                                        headerFormat: '<div class="newTip"><big>{point.key}</big><br/>',
                                        pointFormat: '{point.y} / 5.0',
                                        footerFormat: '</div>',
                                        valueDecimals: 1
                                        },
                                        yAxis: {
                                        gridLineInterpolation: 'polygon',
                                        min: 0,
                                        max: 5,
                                        tickInterval: 1,
                                        minorTickInterval: 0.5,
                                        showLastLabel: 'true',
                                        labels: {
                                            x: 8,
                                            style: {
                                            color: '#000',
                                            textShadow: '1px 1px 0px #fff',
                                            display: "inline-block"
                                            }
                                        }
                                        },
                                        plotOptions: {
                                        series: {
                                            pointStart: 0,
                                            pointInterval: 1
                                        },
                                        column: {
                                            pointPadding: 0,
                                            groupPadding: 0
                                        }
                                        },
                                        series: [{
                                        type: 'area',
                                        name: 'Skills',
                                        data: averageRatings,
                                        pointPlacement: 'on'
                                        }]
                                    });
                                    });
                                </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

